<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Consensus AI - Simple Version</title>
	<style>
		body { background: #18181b; color: #f3f3f3; font-family: Arial, sans-serif; margin: 0; }
		.container { max-width: 600px; margin: 40px auto; background: #23232a; border-radius: 12px; box-shadow: 0 2px 16px #0004; padding: 32px; }
		h1 { text-align: center; color: #60a5fa; margin-bottom: 8px; }
		.models { display: flex; justify-content: center; gap: 24px; margin-bottom: 16px; }
		.model { text-align: center; font-size: 18px; }
		.input-group { margin-bottom: 16px; }
		input[type="text"] { width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #444; background: #18181b; color: #f3f3f3; font-size: 16px; }
		.dropzone { border: 2px dashed #444; border-radius: 6px; padding: 16px; text-align: center; background: #18181b; color: #aaa; margin-bottom: 8px; cursor: pointer; }
		button { width: 100%; padding: 12px; background: #2563eb; color: #fff; border: none; border-radius: 6px; font-size: 18px; font-weight: bold; cursor: pointer; margin-bottom: 16px; }
		button:disabled { background: #444; cursor: not-allowed; }
		.results { margin-top: 24px; }
		.answer { background: #23232a; border-radius: 8px; margin-bottom: 12px; padding: 16px; box-shadow: 0 1px 8px #0002; }
		.answer.best { border: 2px solid #2563eb; background: #1e293b; }
		.answer.consensus { background: linear-gradient(90deg,#2563eb,#60a5fa); color: #fff; border: 2px solid #2563eb; }
		.model-tag { font-weight: bold; color: #60a5fa; margin-right: 8px; }
		.prob { font-size: 14px; font-weight: bold; padding: 2px 8px; border-radius: 12px; margin-left: 8px; }
		.prob.high { background: #22c55e; color: #fff; }
		.prob.med { background: #eab308; color: #222; }
		.prob.low { background: #ef4444; color: #fff; }
		.ocr { color: #22c55e; font-size: 14px; margin-bottom: 8px; }
	</style>
</head>
<body>
	<div class="container">
		<h1>Consensus AI</h1>
		<div class="models">
			<div class="model">üß† DeepSeek</div>
			<div class="model">ü§ñ Kimi</div>
			<div class="model">üêâ Qwen</div>
			<div class="model">üíé Gemma</div>
		</div>
		<form id="askForm">
			<div class="input-group">
				<label for="question"><b>Type your question:</b></label>
				<input type="text" id="question" name="question" placeholder="Enter your question here...">
			</div>
			<div class="input-group">
				<div id="dropzone" class="dropzone">Drag & drop an image here, or click to select</div>
				<input type="file" id="imageInput" name="image" accept="image/*" style="display:none">
				<div id="ocrText" class="ocr"></div>
			</div>
			<button type="submit" id="askBtn">Ask</button>
		</form>
		<div id="results" class="results"></div>
	</div>
	<script>
		const API_URL = '/api/ask';
		const askForm = document.getElementById('askForm');
		const questionInput = document.getElementById('question');
		const imageInput = document.getElementById('imageInput');
		const dropzone = document.getElementById('dropzone');
		const ocrTextDiv = document.getElementById('ocrText');
		const askBtn = document.getElementById('askBtn');
		const resultsDiv = document.getElementById('results');
		let imageFile = null;

		dropzone.addEventListener('click', () => imageInput.click());
		dropzone.addEventListener('dragover', e => { e.preventDefault(); dropzone.style.background = '#222'; });
		dropzone.addEventListener('dragleave', e => { e.preventDefault(); dropzone.style.background = '#18181b'; });
		dropzone.addEventListener('drop', e => {
			e.preventDefault();
			dropzone.style.background = '#18181b';
			if (e.dataTransfer.files.length) {
				imageFile = e.dataTransfer.files[0];
				dropzone.textContent = 'Image selected: ' + imageFile.name;
			}
		});
		imageInput.addEventListener('change', e => {
			if (e.target.files.length) {
				imageFile = e.target.files[0];
				dropzone.textContent = 'Image selected: ' + imageFile.name;
			}
		});

		askForm.addEventListener('submit', async e => {
			e.preventDefault();
			askBtn.disabled = true;
			resultsDiv.innerHTML = '';
			ocrTextDiv.textContent = '';
			const formData = new FormData();
			if (imageFile) {
				formData.append('image', imageFile);
			} else {
				formData.append('question', questionInput.value);
			}
			try {
				const res = await fetch(API_URL, { method: 'POST', body: formData });
				const data = await res.json();
				if (data.question && imageFile) ocrTextDiv.textContent = 'OCR Extracted: ' + data.question;
				renderResults(data.results, data.bestAnswer);
			} catch (err) {
				resultsDiv.innerHTML = '<div style="color:#ef4444">Error: ' + err.message + '</div>';
			}
			askBtn.disabled = false;
		});

		function renderResults(results, bestAnswer) {
			resultsDiv.innerHTML = '';
			results.forEach(r => {
				let probClass = '';
				if (typeof r.probability === 'number') {
					probClass = r.probability > 80 ? 'high' : r.probability > 50 ? 'med' : 'low';
				}
				let answerClass = 'answer';
				if (r.model === 'Consensus AI') answerClass += ' consensus';
				if (bestAnswer && r.model === bestAnswer.model) answerClass += ' best';
				resultsDiv.innerHTML += `
					<div class="${answerClass}">
						<span class="model-tag">${r.model === 'Consensus AI' ? 'üß© Consensus AI' : r.model}</span>
						${typeof r.probability === 'number' && r.model !== 'Consensus AI' ? `<span class="prob ${probClass}">${r.probability}%</span>` : ''}
						<div style="margin-top:8px">${r.answer}</div>
					</div>
				`;
			});
		}
	</script>
</body>
</html>